<template name="showPersonWrapper">
  {{#if ready }}
    {{> DetailWrapper document=selectedPersonDoc ready=ready }}
  {{/if}}
</template>

<template name="personView">
  {{#with person }}
  <div class="container">
    <div class='viewWrapper'>
      <div class='datos-generales clearfix'>
        <div class="gd-col-left-wrapper col-m-12">
          {{#if name }}
            <div class="description-data-name">
              <h3><img src="../images/icons/persona-gray.svg" alt="Ícono persona" class="icon-lf icon-lf-person">{{ name }}</h3>
              <h4 class="person-type">Empresario(a)</h4>
            </div>
            <hr>
          {{/if}}

          <!-- <table class="table">
            <tbody>

              {{#if prefix }}
                <tr class="description-data-prefix">
                  <td>{{__ "prefix" }}</td>
                  <td>{{prefix}}</td>
                </tr>
              {{/if}}
              {{#if suffix }}
                <tr class="description-data-suffix">
                  <td>{{__ "suffix" }}</td>
                  <td>{{suffix}}</td>
                </tr>
              {{/if}}
              {{#if gender }}
                <tr class="description-data-gender">
                  <td>{{__ "gender" }}</td>
                  <td>{{gender}}</td>
                </tr>
              {{/if}}
              {{#if nationality }}
                <tr class="description-data-nationality">
                  <td>{{__ "nationality" }}</td>
                  <td>{{nationality}}</td>
                </tr>
              {{/if}}
              {{#if date_of_birth }}
                <tr class="description-data-dateofbirth">
                  <td>{{__ "date of birth" }}</td>
                  <td>{{date_of_birth}}</td>
                </tr>
              {{/if}}
              {{#if date_of_death }}
                <tr class="description-data-dateofdeath">
                  <td>{{__ "date of death"}}</td>
                  <td>{{date_of_death}}</td>
                </tr>
              {{/if}}
            </tbody>
          </table> -->
        </div>

        <div class="col-m-12">
          <h4 class="description-data-subtitle">EMPRESAS</h4>
        </div>
        <!-- <div class="col-m-6">
          <h5 class="description-data-subname">NOMBRE</h5>
          <div class="description-data-organization"><img src="../images/icons/organizacion-blue.svg" alt="Ícono persona" class="icon-lf icon-lf-organization">BBVA BANCOMER</div>
          <div class="description-data-organization"><img src="../images/icons/organizacion-blue.svg" alt="Ícono persona" class="icon-lf icon-lf-organization">GRUPO NACIONAL PROVINCIAL</div>
          <div class="description-data-organization"><img src="../images/icons/organizacion-blue.svg" alt="Ícono persona" class="icon-lf icon-lf-organization">DINE SAV DE CV</div>
        </div>
        <div class="col-m-6">
          <h5 class="description-data-subname">ROL</h5>
          <div class="description-data-rol">Director</div>
          <div class="description-data-rol">Chairman, Chairman of Finance & Planning Committee</div>
          <div class="description-data-rol">Director Independiente</div>
        </div> -->
        <div class="col-m-12 mb-3">
          <table class="table table-responsive">
            <thead>
              <tr>
                <th class="description-data-subname">Nombre</th>
                <th class="description-data-subname">Rol</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="description-data-organization"><img src="../images/icons/organizacion-blue.svg" alt="Ícono persona" class="icon-lf icon-lf-organization">BBVA BANCOMER</td>
                <td class="description-data-rol">Director</td>
              </tr>
              <tr>
                <td class="description-data-organization"><img src="../images/icons/organizacion-blue.svg" alt="Ícono persona" class="icon-lf icon-lf-organization">GRUPO NACIONAL PROVINCIAL</td>
                <td class="description-data-rol">Chairman, Chairman of Finance & Planning Committee</td>
              </tr>
              <tr>
                <td class="description-data-organization"><img src="../images/icons/organizacion-blue.svg" alt="Ícono persona" class="icon-lf icon-lf-organization">DINE SAV DE CV</td>
                <td class="description-data-rol">Director Independiente</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="col-m-12">
          <h4 class="description-data-subtitle">CONTRATOS</h4>
        </div>
        <div class="col-m-12 mb-3">
          <table class="table table-responsive">
            <thead>
              <tr>
                <th class="description-data-subname">Nombre</th>
                <th class="description-data-subname">Importe</th>
                <th class="description-data-subname">Periodo</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="description-data-contract"><img src="../images/icons/contrato-blue.svg" alt="Ícono persona" class="icon-lf icon-lf-contract">CONTRATO SEGURITECH</td>
                <td class="description-data-amount">5,793,345,245 MXN</td>
                <td class="description-data-date">Diciembre 14, 2013 - Diciembre 29, 2013</td>
              </tr>
              <tr>
                <td class="description-data-contract"><img src="../images/icons/contrato-blue.svg" alt="Ícono persona" class="icon-lf icon-lf-contract">SUMINISTRO DE VALES DE DESPENSA PARA EL AÑO 2015</td>
                <td class="description-data-amount">17,660,625,810 MXN</td>
                <td class="description-data-date">Diciembre 14, 2013 - Diciembre 29, 2013</td>
              </tr>
              <tr>
                <td class="description-data-contract"><img src="../images/icons/contrato-blue.svg" alt="Ícono persona" class="icon-lf icon-lf-contract">CONTRATO SEGURITECH</td>
                <td class="description-data-amount">5,793,345,245 MXN</td>
                <td class="description-data-date">Diciembre 14, 2013 - Diciembre 29, 2013</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="col-m-9 mb-3">
          <table class="table table-responsive">
            <thead>
              <tr>
                <th class="description-data-subname">Cantidad</th>
                <th class="description-data-subname">Importes</th>
                <th class="description-data-subname">Periodo</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="description-data-contract">900</td>
                <td class="description-data-amount">5,793,345,245 MXN</td>
                <td class="description-data-date">Diciembre 14, 2013 - Diciembre 29, 2013</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="col-m-3 centered contract-button">
          <a href="" class="button-link">Ver todos los contratos</a>
        </div>
        <div class="col-m-12">
          <h4 class="description-data-subtitle">GRÁFICO DE RELACIONES</h4>
        </div>
      </div>

      {{#if address }}
        <div class="address clearfix">
          <h3 class="detail_header">{{__ "address" }}</h3>
          <table class="table">
            <tbody>
              {{#each arrayify address }}
                <tr>
                  <td>{{__ name }}</td>
                  <td>{{value}}</td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      {{/if}}
      {{> Memberships }}
    </div>
  </div>
  {{/with}}

  <div class="container addinfo">
    <div class="col-m-12 col-12">
      <hr>
    </div>
    <div class="col-m-12">
      <h4 class="addinfo-title ">¿Conoces más información? Puedes ayudarnos a completar este perfil.</h4>
    </div>
    <div class="col-m-8 col-8">
      <form action="" class="addinfo-form">
        <div class="form-group">
          <label>SI TIENES INFORMACIÓN PARA APORTAR A ESTA PERSONA, AGRÉGALA AQUÍ.</label>
          <textarea class="form-control" rows="6" placeholder="ESCRIBE LOS DATOS QUE DESEAS APORTAR"></textarea>
        </div>
        <div class="form-group">
          <label>FUENTE</label>
          <input class="form-control" type="text" placeholder="AGREGA LA FUENTE DE INFORMACIÓN">
        </div>
        <div class="mt-2">
          <a href="" class="button-link" target="_blank">ENVIAR</a>
        </div>
      </form>
    </div>
    <div class="col-m-4 col-4">
      <div class="addinfo-box">
        <h4>SI DESESAS FILTRAR LOS DATOS ANÓNIMAMENTE, ACCEDE A</h4>
        <img src="../images/mexicoleaks-negro.png" alt="Mexicoleaks Logo" class="addinfo-box-logo">
        <p>Una plataforma de filtración de datos anónima y segura que verifica la información proporcionada.</p>
        <div class="mt-2 mb-1">
          <a href="https://mexicoleaks.mx/enviar-para.php?r=poder" class="button-link" target="_blank">ACCEDER</a>
        </div>
      </div>
    </div>
  </div>
</template>

<template name="PersonSubmit">
  {{#if authInProcess}}
    <p>&nbsp;</p>
  {{else}}
    {{#if is_admin}}
      {{> person_update_form
        meteormethod="Persons.methods.insert"
        formType='method'
      }}
    {{else}}
      <p id="unauthorized">No tienes permiso de ver esta página. Escribe a
        <a href="info@quienesquien.wiki">info@quienesquien.wiki</a>
        para obtener acceso.</p>
    {{/if}}
  {{/if}}
</template>

<template name="PersonHistory">
  <ul>
    <li>
      <a class="rev-link" href="/persons/{{person._id}}#draft">ultimo versión</a>.
      {{#if person.user_id }}
        actualizado por
        <i>{{ updatedBy person.user_id }}</i>.
      {{/if}}
    </li>
    {{#each revisions}}
      <li>
        actualizado por
        <i>{{ updatedBy user_id }}</i>
        <a class="rev-link" href="/persons/{{personId}}/revisions/{{revisionId}}#draft">{{ fromNow lastModified }}</a>.
      </li>
    {{/each}}
  </ul>
</template>

<template name="person_update_form">
  <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
    {{#autoForm collection=personsCollection
  doc=selectedPersonDoc
  id="updatePersonForm"
  type=formType
  meteormethod=meteormethod
  singleMethodArgument=true
}}
      <!-- datos generales -->
      <div class="panel panel-default">
        <div class="panel-heading" role="tab" id="general_data_heading">
          <h4 class="panel-title text-capitalize">
            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#general_data_collapse" aria-expanded="true" aria-controls="general_data_collapse">
              {{__ 'general data'}}
            </a>
          </h4>
        </div>
        <div id="general_data_collapse" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="general_data_heading">
          <div class="panel-body">
            {{> afQuickField name='name'}}
            {{> afQuickField name='prefix'}}
            {{> afQuickField name='suffix'}}
            {{> afQuickField name='gender' options="allowed"}}
            {{> afQuickField name='nationality'}}
            {{> afQuickField name='date_birth'}}
            {{> afQuickField name='date_death'}}
          </div>
        </div>
      </div>
      <!-- datos generales -->
      <!-- address -->
      <div class="panel panel-default">
        <div class="panel-heading" role="tab" id="address_heading">
          <h4 class="panel-title text-capitalize">
            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#address_collapse" aria-expanded="true" aria-controls="address_collapse">
              {{__ "address"}}
            </a>
          </h4>
        </div>
        <div id="address_collapse" class="panel-collapse collapse" role="tabpanel" aria-labelledby="address_heading">
          <div class="panel-body">
            {{> afQuickField name='address'}}
          </div>
        </div>
      </div>
      <!-- address -->
      <!-- references -->
      <div class="panel panel-default">
        <div class="panel-heading" role="tab" id="references_heading">
          <h4 class="panel-title text-capitalize">
            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#references_collapse" aria-expanded="true" aria-controls="references_collapse">
              {{__ "references"}}
            </a>
          </h4>
        </div>
        <div id="references_collapse" class="panel-collapse collapse" role="tabpanel" aria-labelledby="references_heading">
          <div class="panel-body">
            {{> afQuickField name='references' minCount=1}}
          </div>
        </div>
      </div>
      <!-- references -->
      <button type="submit" class="btn btn-primary">{{__ "Submit"}}</button>
    {{/autoForm}}
    <!-- FIXME enable following further testing and improvements
    {{> editMemberships doc=selectedPersonDoc}}
    -->
  </div>
  <!-- id="accordion" -->
</template>
